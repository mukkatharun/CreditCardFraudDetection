## CreditCardFraudDetection


#  Objective
The main objective is to perform predictive analysis on credit card transaction dataset using machine learning techniques and detect the fraudulent transactions from the given dataset. The focus is to identify if a transaction comes under normal class or fraudulent class using predictive models. Different sampling techniques will be implemented and a series of machine learning algorithms will be implemented on the dataset, and the results will be reported.

#  Data Description
Datasets are an integral part in the field of machine learning. Gathering data is one of the hardest tasks, especially when it is related to the financial domain like credit card fraud. The dataset considered from Kaggle contains the record of credit card transactions made by European cardholders and occurred in two days in September 2013. The dataset contains 284,807 transactions out of which only 492 are fraudulent. The dataset is highly unbalanced as the positive class accounts for only 0.172% of the total transactions.
The dataset contains 30 independent variables. Features V1, V2, …., V28 are the principal components obtained with PCA, and the only features that have not been transformed into principal components are ‘Amount’ and ‘Time’. The ‘Class’ attribute is a discrete-valued binary attribute that takes value ‘0’ for non-fraudulent transactions and ‘1’ for fraud transactions.

#  Data Selection
The ‘Time’ feature which is of no use to build the models, can be neglected. The remaining features are the ‘Amount’ feature that contains the total amount of money being transacted, features V1 to V28 which are the principal components obtained by PCA and the ‘Class’ feature that contains whether the transaction is a fraud case or not.

#  Data Preprocessing
There are only 492 fraud cases out of 284,807 samples which is only 0.172% of the total samples. Hence, the dataset is highly unbalanced. To resolve this issue, resampling techniques like SMOTE (Oversampling) and TOMEK Link (Under sampling) will be performed.

#  Data Transformation
There are a total 30 features out of which 28 features have been generated by principal component analysis. PCA is a dimensionality-reduction technique in which a large number of original variables are condensed into a smaller subset of feature variables. The only features that have not been transformed into principal components are ‘Amount’ and ‘Time’.
The values in the ‘Amount’ variable are varying enormously when compared to the rest of the variables. To reduce its wide range of values, it needs to be normalized using the standard scaler technique.

#  Data Mining
Predictive Analysis is performed by building classification models like XG Boost, Decision tree and K-Nearest Neighbors (KNN) to classify fraud transactions.

#  Evaluation
Evaluation of the created classification models is performed using F1-Score matrix and Confusion matrix.

#  Feature Engineering
There are a total 30 independent features out of which 28 features have been generated by principal component analysis. The only features that have not been transformed into principal components are ‘Amount’ and ‘Time’.    
Feature ‘Time’ contains the second elapsed between each transaction and the first transaction in the dataset, and it is not included in our analysis because it is just a timestamp, which is unrelated to our analysis.   
Feature ‘Class’ is the response variable and it takes value ‘1’ for fraud transactions and ‘0’ for non-fraud transactions. Finally, 29 independent variables and one dependent variable are considered for analysis.   
The values in the ‘Amount’ variable are varying enormously when compared to the rest of the variables. To reduce its wide range of values, it needs to be normalized between (-1, 1) using the ‘StandardScaler’ method in Python.   
There are only 492 fraud cases out of 284,807 samples which is only 0.172% of the total samples. Hence, the dataset is highly unbalanced. To resolve this issue, resampling techniques like SMOTE (Oversampling) and TOMEK Link (Under sampling) will be performed.   
The approach is to heavily over-sample the fraudulent transaction class using SMOTE and use Tomek Links to lightly under-sample the legitimate transaction class. The most important aspect of this is the over-sampling. However, the way ‘imblearn’ package implements this combination of under- and over-sampling is to first under-sample and then over-sample because it is more efficient.   
The goal of the TOMEK Link (under-sampling) is to eliminate some of the legitimate transactions that are near the edges of, or are surrounded by, the set of fraudulent transactions. This will make the boundary between the two classes more clear. Under-sampling first will make the generation of new fraudulent transaction members more efficient and will produce more homogeneity with respect to the geometric/spatial distributions of the two classes.   
The classical version of SMOTE (Synthetic Minority Over-sampling Technique) does the following to create synthetic minority class samples.   
•	First, SMOTE chooses a minority class data point.   
•	Then, SMOTE uses part of the k-Nearest Neighbors (kNN) method to find other minority class data points nearby.   
•	Then, SMOTE creates synthetic minority samples that lie on the lines connecting the chosen minority class point to some or all of its nearest neighbors of the same class.   
The split between testing and training needs to be done before any over- or under-sampling is performed. The data science terminology for this type of error is data leakage.    Care must be taken to avoid doing this. The test set data points must be representative in both the features of the data and the class imbalance or we will not be able to have the confidence to generalize the model to detect credit card fraud on other credit fraud datasets.   



References:    
[1] Bertrand Lebichot, Fabian Braun, Olivier Caelen, and Marco Saerens. A graph-based, semi-supervised, credit card fraud detection system. In COMPLEX NETWORKS, 2016.   
[2] John O. Awoyemi, Adebayo Olusola Adetunmbi, and Samuel Adebayo Oluwadare. Credit card fraud detection using machine learning techniques: A comparative analysis. 2017 International Conference on Computing Networking and Informatics (ICCNI), pages 1–9, 2017.   
[3] Piotr Juszczak, Niall M. Adams, David J. Hand, Christopher Whitrow, and David John Weston. Off-the-peg and bespoke classifiers for fraud detection. Computational Statistics Data Analysis, 52:4521–4532, 2008.   
[4] Sam Maes, Karl Tuyls, Bram Vanschoenwinkel, and Bernard Manderick. Credit card fraud detection using bayesian and neural networks. In: Maciunas RJ, editor. Interactive image-guided neurosurgery. American Association Neurological Surgeons, pages 261–270, 1993.   
[5] Ronish Shakya. Application of Machine Learning Techniques in Credit Card Card Fraud Detection.   
[6] Chawla, N. V., Bowyer, K. W., Hall, L. O., & Kegelmeyer, W. P. SMOTE: synthetic minority over-sampling technique.   
